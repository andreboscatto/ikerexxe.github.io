---
layout:     post
title:      "The CVE imbroglio"
date:       2023-02-15 12:00:00 +0100
categories: idm
---

Last week while reviewing a [shadow-utils PR](https://github.com/shadow-maint/shadow/pull/642) I discovered a very [suspicious issue reported by CodeQL](https://github.com/shadow-maint/shadow/security/code-scanning/196) in a part of the that hand't been changed in 12 years. It seemed like an easy attack vector by a malicious actor, who could run any process while executing the `newgrp` command by simply changing an environmental variable. If true, many distributions would be affected by this problem. So I asked our product security team to review the problem and open a CVE ([CVE-2023-0634](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-0634)).

Fortunately for us, it all turned out to be just a big fright. The `newgrp` is intended to execute the command, but it will not execute anything privileged because there are already protections in place (setgid) to disable any malicious intent.
